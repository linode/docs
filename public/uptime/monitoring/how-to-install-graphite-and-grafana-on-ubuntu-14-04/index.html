<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Deploy Graphite with Grafana on Ubuntu 14.04</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="description" content="This guide provides an introduction to the installation and basic setup of Graphite together with Grafana on Ubuntu 14.04.">
        <meta name="keywords" content="graphite, grafana, monitor, monitoring, monitoring tool, analytics">
        
        <meta property="og:title" content="Deploy Graphite with Grafana on Ubuntu 14.04">
        <meta property="og:type" content="article">
        <meta property="og:url" content="https://linode.com/docs/uptime/monitoring/how-to-install-graphite-and-grafana-on-ubuntu-14-04/">
        <meta property="og:description" content="This guide provides an introduction to the installation and basic setup of Graphite together with Grafana on Ubuntu 14.04.">
        <meta property="og:site_name" content="Linode Guides &amp; Tutorials">
        
        
        <meta name="twitter:card" content="summary">
        
        <meta name="twitter:site" content="@linode">
        <link rel="alternate" type="application/rss" href="https://linode.com/docs/index.xml">

        
             <link href="/docs/build/stylesheets/home.css" rel='stylesheet' type='text/css'>

        
        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <link href='//fonts.googleapis.com/css?family=Lato:300,400,700,900' rel='stylesheet' type='text/css'>
        <link rel="canonical" href="https://linode.com/docs/uptime/monitoring/how-to-install-graphite-and-grafana-on-ubuntu-14-04/">
        <link rel="shortcut icon" href="/favicon.ico">
    </head>
    <body class="no-subnav">
         <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="searchLabel" id="ds-search-modal">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div id="ds-search-input">
				<div class="input-group col-md-12">
					<input id="ds-search" type="text" class="form-control input-lg" placeholder="Search" />
					<span class="input-group-btn">
						<button class="btn btn-info btn-lg" id="ds-search-btn-modal" type="button">
						<i class="glyphicon glyphicon-search"></i>
						</button>
					</span>
				</div>
				<ul class="list-group" id="ds-search-list">
				</ul>
			</div>
		</div>
	</div>
</div> 
         
        <header>
            <nav id="main-nav" class="navbar navbar-default" role="navigation">
  <div class="container">

    <div class="navbar-header">
      <button type="button" class="toggle navbar-toggle" data-toggle="collapse" data-target=".navbar-top-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="https://www.linode.com"><img id="navbar-logo" src="/docs/media/images/header/linode-logo.svg" style="height:57px"></a>
    </div>

    <div class="collapse navbar-collapse navbar-top-collapse">
      <ul class="nav navbar-nav navbar-right">

                <li><a href="https://www.linode.com/"><span class='nav-home'></span></a></li>
                <li><a href="https://www.linode.com/linodes">Features</a></li>
                <li><a href="https://www.linode.com/pricing">Pricing</a></li>
                <li><a href="https://www.linode.com/addons">Add-ons</a></li>

        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Resources <span class="caret"></span></a>
          <ul class="dropdown-menu dropdown-main-nav dropdown-mega">
            <li class="dropdown-third">
              <ul >
                <li><a href="https://linode.com/docs/getting-started">Getting Started</a></li>
                <li><a href="https://linode.com/docs/migrate-from-shared">Migrating to Linode</a></li>
                <li><a href="https://linode.com/docs/hosting-website">Hosting a Website</a></li>
                <li class="divider"></li>
                <li class="big"><a href="https://linode.com/docs"><i class="fa fa-book"></i> Guides &amp; Tutorials</a></li>
                <li class="divider visible-xs"></li>
              </ul>
            </li>
            <li class="dropdown-third middle">
              <ul >
                <li><a href="https://www.linode.com/api">API</a></li>
                <li><a href="https://www.linode.com/stackscripts">StackScripts</a></li>
                <li><a href="https://www.linode.com/mobile">Mobile</a></li>
                <li><a href="https://www.linode.com/cli" target="_blank">CLI</a></li>

                <li class="divider"></li>

                <li><a href="https://www.linode.com/chat"><i class="fa fa-bullhorn gray"></i> Chat</a></li>
                <li><a href="https://forum.linode.com"><i class="fa fa-comments"></i> Community Forum</a></li>
                <li class="divider visible-xs"></li>
              </ul>
            </li>
            <li class="dropdown-third">
              <ul >
                <li><a href="https://blog.linode.com">Blog</a></li>
                <li><a href="http://status.linode.com">System Status</a></li>
                <li><a href="https://www.linode.com/speedtest">Speed Test</a></li>
                <li><a href="https://www.linode.com/about">About Us</a></li>
                <li class="divider"></li>
                <li><a href="https://www.linode.com/contact"><i class="fa fa-user"></i> Contact Support</a></li>
              </ul>
            </li>
          </ul>
        </li>

        <li role="presentation" class="divider-vertical"><span>|</span></li>
          <li class=""><a href="https://manager.linode.com/">Log in <span class="login-caret"></span></a></li>
          <li class="visible-xs"><a href="https://manager.linode.com/session/signup">Sign up</a></li>
          <li class="hidden-xs"><div><a id="btn-signup-top" class="btn btn-sm btn-green navbar-btn hidden-xs" href="https://manager.linode.com/session/signup">Sign up</a></div></li>
      </ul>
    </div>

  </div>
</nav>

            <nav class="navbar subnav jumbotron" role="navigation">
  <div class="container">
    <div class="subnav-divider">

    </div>
  </div>
</nav>
        </header>
        
<section class="primary first-section">
  <div class="container">
    <div class="row breadcrumb-row">
  <div class="col-sm-12">
    <ol class="breadcrumb library-breadcrumb">
      







<li>
  
  <a href="https://linode.com/docs/">Guides &amp; Tutorials</a>
  
</li>


<li>
  
  <a href="https://linode.com/docs/uptime/">Uptime &amp; Analytics</a>
  
</li>


<li>
  
  <a href="https://linode.com/docs/uptime/monitoring/">Server Monitoring</a>
  
</li>


<li>
  
  Deploy Graphite with Grafana on Ubuntu 14.04
  
</li>

    </ol>
  </div>
</div>

    <div class="row" itemscope itemtype="http://schema.org/TechArticle">
      <div class="col-sm-12">
        <div class="row">
          <div class="col-sm-9 col-sm-offset-3">
          </div>
        </div>
        <div class="row">
          <div id="article-body" class="col-sm-9 col-sm-push-3 doc">
            <h1 class="doc-title" itemprop="headline">Deploy Graphite with Grafana on Ubuntu 14.04</h1>
<p markdown="0" class="doc-time doc-modified-time">
  <small class="updated">Updated <time itemprop="dateModified" datetime="2015-12-02T00:00:00Z">Wednesday, December 2, 2015</time> by Sergey Pariev</small>
  
  <small class="contributed-by">Contributed by
  
  <a href="https://twitter.com/spariev">Sergey Pariev
    
    <i class="fa fa-twitter"></i>
    
  </a>
  
  </small>
  
</p>

           <div class="row">
            <div class="col-sm-9"><div markdown="0" class="signup-top">
    <span>
        Use promo code <strong>DOCS10</strong> for $10 credit on a new account.
    </span>
    <form action="https://manager.linode.com/session/signup" style="display: inline">
        <button type="submit" target="_blank" class="btn btn-blue btn-sm btn-border">Try this Guide</button>
    </form>
</div>
</div>
            <div class="col-sm-3"><div class="social-share">
    <div class="btn-group share-group">
        <a data-toggle="dropdown" class="btn btn-info">
            <i class="fa fa-share-alt fa-inverse"></i>
        </a>
        <button href="#" data-toggle="dropdown" class="btn btn-info dropdown-toggle share">
        <span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
            <li>
                <a data-original-title="Twitter" rel="tooltip"  href="https://twitter.com/share?url=https%3a%2f%2flinode.com%2fdocs%2fuptime%2fmonitoring%2fhow-to-install-graphite-and-grafana-on-ubuntu-14-04%2f&via=linode&text=Deploy%20Graphite%20with%20Grafana%20%e2%80%a6" class="btn btn-twitter" data-placement="left" target="_blank" rel="noopener">
                    <i class="fa fa-twitter"></i>
                </a>
            </li>
            <li>
                <a data-original-title="Facebook" rel="tooltip"  href="http://www.facebook.com/sharer.php?u=https%3a%2f%2flinode.com%2fdocs%2fuptime%2fmonitoring%2fhow-to-install-graphite-and-grafana-on-ubuntu-14-04%2f" class="btn btn-facebook" data-placement="left" target="_blank" rel="noopener">
                    <i class="fa fa-facebook"></i>
                </a>
            </li>
            <li>
                <a data-original-title="Hacker News" rel="tooltip"  href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2flinode.com%2fdocs%2fuptime%2fmonitoring%2fhow-to-install-graphite-and-grafana-on-ubuntu-14-04%2f&t=Deploy%20Graphite%20with%20Grafana%20on%20Ubuntu%2014.04" class="btn btn-hacker-news" data-placement="left" target="_blank" rel="noopener">
                    <i class="fa fa-hacker-news "></i>
                </a>
            </li>
        </ul>
    </div>
</div></div>
            </div>
            <div class="library-github" markdown="0">
	<i class="fa fa-github"></i>
	<strong>Contribute on GitHub</strong>
	<p>
		
		<a href="https://github.com/linode/docs">View Project</a> |
		<a href="https://github.com/linode/docs/blob/master/docs/uptime/monitoring/how-to-install-graphite-and-grafana-on-ubuntu-14-04.md">View File</a> |
		<a href="https://github.com/linode/docs/edit/master/docs/uptime/monitoring/how-to-install-graphite-and-grafana-on-ubuntu-14-04.md">Edit File</a>
	</p>
</div>
            <hr />

<p><em>This is a Linode Community guide. If you&rsquo;re an expert on something for which we need a guide, you too can <a href="/docs/contribute">get paid to write for us.</a></em></p>

<hr />

            

            

<p><img src="/docs/assets/how-to-install-graphite-and-grafana-on-ubuntu-14-04/Deploy_Graphite_smg.jpg" alt="Graphite with Grafana" /></p>

<h1 id="set-up-graphite-monitoring-software-with-grafana-on-ubuntu">Set Up Graphite Monitoring Software with Grafana on Ubuntu</h1>

<p><a href="http://graphite.readthedocs.org/en/latest/index.html">Graphite</a> is an enterprise-level monitoring tool renowned for performing well on systems with limited resources. It stores numeric time-series data and renders graphs of this data on demand. This guide provides an introduction to the installation and basic setup of Graphite together with <a href="http://grafana.org/">Grafana</a>, a popular open source application for visualizing large-scale measurement data, on Ubuntu 14.04.</p>

<h2 id="before-you-begin">Before You Begin</h2>

<ol>
<li><p>Familiarize yourself with our <a href="/docs/getting-started">Getting Started</a> guide and complete the steps for setting your Linode&rsquo;s hostname and timezone.</p></li>

<li><p>This guide will use <code>sudo</code> wherever possible from an example account named <code>graphite</code>. Complete the sections of our <a href="/docs/security/securing-your-server">Securing Your Server</a> guide to create the <code>graphite</code> user, harden SSH access, remove unnecessary network services and set up a firewall. You may need to create additional firewall rules for your specific application.</p></li>

<li><p>Update your system:</p>

<pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade
</code></pre></li>
</ol>

<h2 id="install-apache-python-tools-and-graphite">Install Apache, Python Tools and Graphite</h2>

<ol>
<li><p>Install the system packages required for working with Graphite:</p>

<pre><code>sudo apt-get install build-essential graphite-web graphite-carbon python-dev apache2 libapache2-mod-wsgi libpq-dev python-psycopg2
</code></pre>

<p>During the installation of <code>graphite-carbon</code>, you will be asked if you want to remove the whisper database files should you ever uninstall Graphite. Answer <strong>No</strong> to this prompt. You can always remove the files later (which are located in <code>/var/lib/graphite/whisper</code>).</p></li>
</ol>

<h2 id="configure-carbon">Configure Carbon</h2>

<ol>
<li><p>Configure the retention rate for test metrics by adding a <code>[test]</code> block to Carbon&rsquo;s <code>storage-schemas.conf</code> file. <em>This step is given for testing purposes only and can be safely skipped if you have no use to generate test metrics.</em></p>

<p>The retention times given below will save data every 5 seconds for 3 hours, and a separate set of data from that aggregated sample every 1 minute for 1 day.</p>

<dl class="file-excerpt">
<dt>


		/etc/carbon/storage-schemas.conf 


</dt>
<dd>




<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1</span><span class="lnt"> 2</span><span class="lnt"> 3</span><span class="lnt"> 4</span><span class="lnt"> 5</span><span class="lnt"> 6</span><span class="lnt"> 7</span><span class="lnt"> 8</span><span class="lnt"> 9</span><span class="lnt">10</span><span class="lnt">11</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>carbon<span class="o">]</span>
<span class="nv">pattern</span> <span class="o">=</span> ^carbon<span class="se">\.</span>
<span class="nv">retentions</span> <span class="o">=</span> <span class="m">60</span>:90d

<span class="o">[</span>test<span class="o">]</span>
<span class="nv">pattern</span> <span class="o">=</span> ^test<span class="se">\.</span>
<span class="nv">retentions</span> <span class="o">=</span> 5s:3h,1m:1d

<span class="o">[</span>default_1min_for_1day<span class="o">]</span>
<span class="nv">pattern</span> <span class="o">=</span> .*
<span class="nv">retentions</span> <span class="o">=</span> 60s:1d</code></pre></td></tr></table>
</div>
</div>
</dd>
</dl>


<p>For more information on how to configure Carbon storage, see the section <a href="http://graphite.readthedocs.org/en/latest/config-carbon.html#storage-schemas-conf">storage-schemas.conf</a> in Graphite&rsquo;s documentation.</p></li>

<li><p>Copy the default aggregation configuration to <code>/etc/carbon</code> so we can configure our own settings:</p>

<pre><code>sudo cp /usr/share/doc/graphite-carbon/examples/storage-aggregation.conf.example /etc/carbon/storage-aggregation.conf
</code></pre>

<p><code>storage-aggregation.conf</code> describes aggregation policies Carbon uses to produce less detailed metrics, such as the 1m:1d retention in the [test] block added above. By default, only the average metric value is taken, which will result in data loss when, for example, you need maximum and minimum values. For this reason, <code>[min]</code>,<code>[max]</code> and <code>[sum]</code> sections are found in the configuration file.</p></li>

<li><p>Enable Carbon&rsquo;s cache to run on boot:</p>

<dl class="file-excerpt">
<dt>


		/etc/default/graphite-carbon 


</dt>
<dd>




<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nv">CARBON_CACHE_ENABLED</span><span class="o">=</span>true</code></pre></td></tr></table>
</div>
</div>
</dd>
</dl>
</li>

<li><p>Start the Carbon cache service:</p>

<pre><code>sudo service carbon-cache start
</code></pre></li>
</ol>

<h2 id="install-and-configure-postgresql">Install and Configure PostgreSQL</h2>

<ol>
<li><p>Install PostgreSQL for the graphite-web application:</p>

<pre><code>sudo apt-get install postgresql
</code></pre></li>

<li><p>Change to the <code>postgres</code> user and create a database user for Graphite:</p>

<pre><code>su - postgres
createuser graphite --pwprompt
</code></pre>

<p>You will be asked to provide a password for the new database user. After that, create the databases <code>graphite</code> and <code>grafana</code> with the system&rsquo;s <code>graphite</code> user as the owner:</p>

<pre><code>createdb -O graphite graphite
createdb -O graphite grafana
</code></pre></li>

<li><p>When finished configuring the PostgreSQL databases, change back to the <code>graphite</code> user:</p>

<pre><code>su - graphite
</code></pre></li>
</ol>

<h2 id="configure-graphite">Configure Graphite</h2>

<ol>
<li><p>Update Graphite&rsquo;s <code>DATABASES</code> dictionary definition with the settings for the PostgreSQL database created earlier:</p>

<dl class="file-excerpt">
<dt>


		/etc/graphite/local_settings.py 


</dt>
<dd>







<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-py" data-lang="py"><span class="lnt"> 1</span><span class="lnt"> 2</span><span class="lnt"> 3</span><span class="lnt"> 4</span><span class="lnt"> 5</span><span class="lnt"> 6</span><span class="lnt"> 7</span><span class="lnt"> 8</span><span class="lnt"> 9</span><span class="lnt">10</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-py" data-lang="py"><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sa"></span><span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="sa"></span><span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="sa"></span><span class="s1">&#39;graphite&#39;</span><span class="p">,</span>
        <span class="sa"></span><span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="sa"></span><span class="s1">&#39;django.db.backends.postgresql_psycopg2&#39;</span><span class="p">,</span>
        <span class="sa"></span><span class="s1">&#39;USER&#39;</span><span class="p">:</span> <span class="sa"></span><span class="s1">&#39;graphite&#39;</span><span class="p">,</span>
        <span class="sa"></span><span class="s1">&#39;PASSWORD&#39;</span><span class="p">:</span> <span class="sa"></span><span class="s1">&#39;graphiteuserpassword&#39;</span><span class="p">,</span>
        <span class="sa"></span><span class="s1">&#39;HOST&#39;</span><span class="p">:</span> <span class="sa"></span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span>
        <span class="sa"></span><span class="s1">&#39;PORT&#39;</span><span class="p">:</span> <span class="sa"></span><span class="s1">&#39;&#39;</span>
        <span class="p">}</span>
    <span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
</dd>
</dl>
</li>

<li><p>Also add the following lines to the end of the file:</p>

<dl class="file-excerpt">
<dt>


		/etc/graphite/local_settings.py 


</dt>
<dd>







<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-py" data-lang="py"><span class="lnt">1</span><span class="lnt">2</span><span class="lnt">3</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-py" data-lang="py"><span class="n">USE_REMOTE_USER_AUTHENTICATION</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">TIME_ZONE</span> <span class="o">=</span> <span class="sa"></span><span class="s1">&#39;Your/Timezone&#39;</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="sa"></span><span class="s1">&#39;somelonganduniquesecretstring&#39;</span></code></pre></td></tr></table>
</div>
</div>
</dd>
</dl>


<ul>
<li><p>TIME_ZONE is your Linode&rsquo;s time zone, which will be used in graphs. For possible values, run <code>timedatectl</code> or see the <em>TZ</em> column in <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">Wikipedia&rsquo;s timezone database</a>.</p></li>

<li><p>SECRET_KEY is a long and unique string used as a salt when hashing passwords.</p></li>
</ul></li>

<li><p>Initialize the database with:</p>

<pre><code>sudo graphite-manage syncdb
</code></pre></li>

<li><p>Then answer the prompts to create a superuser account which will be used to access Graphite&rsquo;s web interface.</p></li>
</ol>

<h2 id="configure-apache-for-graphite">Configure Apache for Graphite</h2>

<ol>
<li><p>Copy Graphite&rsquo;s Apache config template into Apache&rsquo;s <code>sites-available</code> directory:</p>

<pre><code>sudo cp /usr/share/graphite-web/apache2-graphite.conf /etc/apache2/sites-available
</code></pre></li>

<li><p>Change Graphite&rsquo;s port from 80 to 8080 (port 80 will be used for Grafana later).</p>

<dl class="file">
<dt>


		/etc/apache2/sites-available/apache2-graphite.conf 


</dt>
<dd>







<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-aconf" data-lang="aconf"><span class="lnt">1</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-aconf" data-lang="aconf"><span class="nt">&lt;VirtualHost</span> <span class="s">*:8080</span><span class="nt">&gt;</span></code></pre></td></tr></table>
</div>
</div>
</dd>
</dl></li>

<li><p>Make sure Apache is listening on port 8080. Add <code>Listen 8080</code> after <code>Listen 80</code> in <code>ports.conf</code>:</p>

<dl class="file-excerpt">
<dt>


		/etc/apache2/ports.conf 


</dt>
<dd>







<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-aconf" data-lang="aconf"><span class="lnt">1</span><span class="lnt">2</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-aconf" data-lang="aconf"><span class="nb">Listen</span> <span class="m">80</span>
<span class="nb">Listen</span> <span class="m">8080</span></code></pre></td></tr></table>
</div>
</div>
</dd>
</dl>
</li>

<li><p>Disable the default Apache site to avoid conflicts:</p>

<pre><code>sudo a2dissite 000-default
</code></pre></li>

<li><p>Enable Graphite&rsquo;s virtual site:</p>

<pre><code>sudo a2ensite apache2-graphite
</code></pre></li>

<li><p>Reload Apache to apply the changes:</p>

<pre><code>sudo service apache2 reload
</code></pre>

<p>Now you should be able to access Graphite by going to your Linode&rsquo;s hostname or IP address using port 8080 in a web browser (ex: <code>example_domain.com:8080</code>). You&rsquo;ll see the Graphite landing page as shown below:</p>

<p><img src="/docs/assets/graphite_landing_page.png" alt="Graphite landing page" /></p></li>
</ol>

<h2 id="create-sample-data">Create Sample Data</h2>

<ol>
<li><p>Generate some test metrics with the following command:</p>

<pre><code>for i in 4 6 8 16 2; do echo &quot;test.count $i `date +%s`&quot; | nc -q0 127.0.0.1 2003; sleep 6; done
</code></pre></li>

<li><p>Wait for the command prompt to be returned. Refresh the page and you should see a new <code>test.count</code> metric in the tree on the left:</p>

<p><img src="/docs/assets/graphite_test_metric.png" alt="Graphite test metric" /></p></li>
</ol>

<h2 id="install-and-configure-grafana">Install and Configure Grafana</h2>

<ol>
<li><p>Add Grafana&rsquo;s repository to <code>sources.list</code>:</p>

<pre><code>echo 'deb https://packagecloud.io/grafana/stable/debian/ wheezy main' |  sudo tee -a /etc/apt/sources.list
</code></pre></li>

<li><p>Add the <a href="https://packagecloud.io/grafana">Package Cloud</a> key to install signed packages:</p>

<pre><code>curl https://packagecloud.io/gpg.key | sudo apt-key add -
</code></pre></li>

<li><p>Update apt and install Grafana:</p>

<pre><code>sudo apt-get update &amp;&amp; sudo apt-get install grafana
</code></pre></li>

<li><p>Configure Grafana to use the PostgreSQL database created earlier:</p>

<dl class="file-excerpt">
<dt>


		/etc/grafana/grafana.ini 


</dt>
<dd>







<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-ini" data-lang="ini"><span class="lnt">1</span><span class="lnt">2</span><span class="lnt">3</span><span class="lnt">4</span><span class="lnt">5</span><span class="lnt">6</span><span class="lnt">7</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ini" data-lang="ini"><span class="k">[database]</span>
<span class="c1"># Either &#34;mysql&#34;, &#34;postgres&#34; or &#34;sqlite3&#34;, it&#39;s your choice</span>
<span class="na">type</span> <span class="o">=</span> <span class="s">postgres</span>
<span class="na">host</span> <span class="o">=</span> <span class="s">127.0.0.1:5432</span>
<span class="na">name</span> <span class="o">=</span> <span class="s">grafana</span>
<span class="na">user</span> <span class="o">=</span> <span class="s">graphite</span>
<span class="na">password</span> <span class="o">=</span> <span class="s">graphiteuserpassword</span></code></pre></td></tr></table>
</div>
</div>
</dd>
</dl>
</li>

<li><p>Also in <code>/etc/grafana/grafana.ini</code>, configure the <code>domain</code> and <code>root_url</code>, and set a strong admin password and secret key:</p>

<dl class="file-excerpt">
<dt>


		/etc/grafana/grafana.ini 


</dt>
<dd>







<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-ini" data-lang="ini"><span class="lnt"> 1</span><span class="lnt"> 2</span><span class="lnt"> 3</span><span class="lnt"> 4</span><span class="lnt"> 5</span><span class="lnt"> 6</span><span class="lnt"> 7</span><span class="lnt"> 8</span><span class="lnt"> 9</span><span class="lnt">10</span><span class="lnt">11</span><span class="lnt">12</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ini" data-lang="ini"><span class="k">[server]</span>
<span class="na">protocol</span> <span class="o">=</span> <span class="s">http</span>
<span class="na">http_addr</span> <span class="o">=</span> <span class="s">127.0.0.1</span>
<span class="na">http_port</span> <span class="o">=</span> <span class="s">3000</span>
<span class="na">domain</span> <span class="o">=</span> <span class="s">example.com</span>
<span class="na">enforce_domain</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">root_url</span> <span class="o">=</span> <span class="s">%(protocol)s://%(domain)s/</span>

<span class="k">[security]</span>
<span class="na">admin_user</span> <span class="o">=</span> <span class="s">admin</span>
<span class="na">admin_password</span> <span class="o">=</span> <span class="s">SecureAdminPass</span>
<span class="na">secret_key</span> <span class="o">=</span> <span class="s">somelongrandomstringkey</span></code></pre></td></tr></table>
</div>
</div>
</dd>
</dl>
</li>

<li><p>Enable proxy modules for Apache reverse proxying to work:</p>

<pre><code>sudo a2enmod proxy proxy_http xml2enc
</code></pre></li>

<li><p>Create an Apache site configuration file to proxy requests to Grafana. Remember to change <code>example.com</code> to your own domain:</p>

<dl class="file">
<dt>


		/etc/apache2/sites-available/apache2-grafana.conf 


</dt>
<dd>







<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-aconf" data-lang="aconf"><span class="lnt">1</span><span class="lnt">2</span><span class="lnt">3</span><span class="lnt">4</span><span class="lnt">5</span><span class="lnt">6</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-aconf" data-lang="aconf"><span class="nt">&lt;VirtualHost</span> <span class="s">*:80</span><span class="nt">&gt;</span>
    <span class="nb">ProxyPreserveHost</span> <span class="k">On</span>
    <span class="nb">ProxyPass</span> / http://127.0.0.1:3000/
    <span class="nb">ProxyPassReverse</span> / http://127.0.0.1:3000/
    <span class="nb">ServerName</span> example.com
<span class="nt">&lt;/VirtualHost</span><span class="s"></span><span class="nt">&gt;</span></code></pre></td></tr></table>
</div>
</div>
</dd>
</dl></li>

<li><p>Enable Grafana&rsquo;s site configuration with:</p>

<pre><code>sudo a2ensite apache2-grafana
</code></pre></li>

<li><p>Configure Grafana to run after boot and then start service:</p>

<pre><code>sudo update-rc.d grafana-server defaults 95 10
sudo service grafana-server start
</code></pre></li>

<li><p>Restart Apache to load the new modules and configuration changes:</p>

<pre><code>sudo service apache2 restart
</code></pre>

<p>At this point, you should be able to open your Linode&rsquo;s domain or IP address in a browser to see Grafana&rsquo;s login page.</p></li>
</ol>

<h2 id="add-a-graphite-data-source-to-grafana">Add a Graphite Data Source to Grafana</h2>

<ol>
<li><p>Log in into Grafana using the <code>admin</code> credentials you specified in <code>grafana.ini</code> above.</p></li>

<li><p>Click on <strong>Data Sources</strong> and select <strong>Add new</strong>. Fill in all the fields as shown in the screenshot below:</p>

<p><img src="/docs/assets/graphite_grafana_data_source.png" alt="Add Data Source dialog" /></p>

<p>Click <strong>Save</strong> to create the new Data Source.</p></li>

<li><p>Now, before creating a graph, add more test data for the <code>test.count</code> metric by again running:</p>

<pre><code>for i in 4 6 8 16 2; do echo &quot;test.count $i `date +%s`&quot; | nc -q0 127.0.0.1 2003; sleep 6; done
</code></pre></li>

<li><p>Create a new dashboard by clicking the <strong>Home</strong> button and then <strong>+ New</strong>:</p>

<p><img src="/docs/assets/graphite_grafana_new_dashboard.png" alt="Create new dashboard" /></p></li>

<li><p>Add a Graph panel to the newly created dashboard:</p>

<p><img src="/docs/assets/graphite_grafana_new_graph.png" alt="Create new graph panel" /></p></li>

<li><p>Edit the Graph panel properties by clicking the tab with the words <strong>no title (click here)</strong>. Then click <strong>Edit</strong>:</p>

<p><img src="/docs/assets/graphite_grafana_edit_graph.png" alt="Edit graph panel" /></p></li>

<li><p>Make sure the <strong>graphite</strong> data source you&rsquo;ve created is chosen in the dropdown box at the bottom right (marked as 1 in the screenshot below). In the dropdown at the top right corner (marked as 2), choose <strong>Last 15 minutes</strong>.</p>

<p>Click <strong>select metric</strong>. Choose <strong>test</strong> and then <strong>count</strong> (marked as 3) to add the test metric you previously created. At this point, the sample data should appear on the graph.</p>

<p>Finally, click the <strong>Save</strong> button (marked as 4) to save the dashboard you just created.</p>

<p><img src="/docs/assets/graphite_grafana_edit_graph_add_metric.png" alt="Add test metric to the panel" /></p></li>
</ol>

            
<h2>More Information</h2>
<p>You may wish to consult the following resources for additional information on this topic. While these are provided in the hope that they will be useful, please note that we cannot vouch for the accuracy or timeliness of externally hosted materials.</p>
<ul>

<li><a href="http://graphite.readthedocs.org/en/latest/install.html">Installing Graphite</a></li>

<li><a href="http://graphite.readthedocs.org/en/latest/config-carbon.html">Configuring Carbon</a></li>

<li><a href="http://docs.grafana.org/installation/debian/">Installing Grafana on Debian/Ubuntu</a></li>

<li><a href="http://docs.grafana.org/datasources/graphite/">Adding Graphite data source to Grafana</a></li>

</ul>


            

<h2>See Also</h2>
<ul>
    
    
    <li><a href="/docs/uptime/analytics/google-analytics-for-websites/">Google Analytics for Websites</a></li>
    
    
    
    <li><a href="/docs/uptime/analytics/google-analytics-on-wordpress/">Google Analytics for WordPress</a></li>
    
    
    
    <li><a href="/docs/uptime/monitoring-and-maintaining-your-server/">Monitoring and Maintaining Your Server</a></li>
    
    
    
    <li><a href="/docs/uptime/monitoring/install-icinga2-monitoring-on-debian-9/">Install Icinga2 Monitoring on Debian 9</a></li>
    
    
    
    <li><a href="/docs/applications/big-data/big-data-in-the-linode-cloud-streaming-data-processing-with-apache-storm/">Big Data in the Linode Cloud: Streaming Data Processing with Apache Storm</a></li>
    
    
</ul>


            
            
<p class="doc-license">This guide is published under a <a href="https://creativecommons.org/licenses/by-nd/4.0">CC BY-ND 4.0</a> license.</p>

          </div>
          <div id="doc-sidebar-container" class="col-sm-3 col-sm-pull-9 hidden-xs">
            <div id="doc-sidebar">
              <div markdown="0" class="doc-sidebar-inner" >
  <div class="input-group">
	<label class="sr-only" for="q">Search guides and tutorials</label>
	<input id="ss_keyword" name="q" type="text" class="form-control" placeholder="Search guides..."/>
	<span class="input-group-btn">
		<button type="submit" class="btn btn-blue" id="ds-search-btn"><span class="glyphicon glyphicon-search"></span></button>
	</span>
</div>
</div>

                
              <div class="doc-sidebar-inner" id="doc-sidebar-toc">
                <h3 id="doc-sidebar-title">In This Guide:</h3>
                <div class="sidebar sidebar-library nav navbar" id="markdown-toc">
                    <nav id="TableOfContents">
<ul>
<li><a href="#set-up-graphite-monitoring-software-with-grafana-on-ubuntu">Set Up Graphite Monitoring Software with Grafana on Ubuntu</a>
<ul>
<li><a href="#before-you-begin">Before You Begin</a></li>
<li><a href="#install-apache-python-tools-and-graphite">Install Apache, Python Tools and Graphite</a></li>
<li><a href="#configure-carbon">Configure Carbon</a></li>
<li><a href="#install-and-configure-postgresql">Install and Configure PostgreSQL</a></li>
<li><a href="#configure-graphite">Configure Graphite</a></li>
<li><a href="#configure-apache-for-graphite">Configure Apache for Graphite</a></li>
<li><a href="#create-sample-data">Create Sample Data</a></li>
<li><a href="#install-and-configure-grafana">Install and Configure Grafana</a></li>
<li><a href="#add-a-graphite-data-source-to-grafana">Add a Graphite Data Source to Grafana</a></li>
</ul></li>
</ul>
</nav>
                </div>
              </div>
              
              <div class="library-rss">
  <a href="https://linode.com/docs/index.xml"><i class="fa fa-rss-square"></i> RSS feed</a>
</div>

              <div markdown="0" class="library-signup">
  <form action="//linode.us7.list-manage.com/subscribe/post?u=f9b54ed743e1629877750e3f4&amp;id=68bafea72a&SIGNUP=library-website"
    method="post" class="email-signup" target="_blank" novalidate="">
    <i class="fa fa-envelope"></i>
    <h6>Monthly Guides Update</h6>
    <input name="EMAIL" type="email" class="form-control input-sm"
    placeholder="Email address" required="" />
    <div style="position: absolute; left: -5000px;" aria-hidden="true">
      <input type="text" name="b_f9b54ed743e1629877750e3f4_68bafea72a"
      tabindex="-1" value="">
    </div>
    <div style="display:none">
      <input type="checkbox" value="4" name="group[13][4]"
      id="mce-group[13]-13-0" checked="">
    </div>
    <button type="submit" class="btn btn-blue btn-sm btn-border email-signup" value="Subscribe"
    name="subscribe" id="mc-embedded-subscribe">Sign Up</button>
  </form>
</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<div class="modal fade" id="img-modal" tabindex="-1" role="dialog" aria-labelledby="imageModal" aria-hidden="true">
  <div class="modal-dialog modal-full">
    <div class="modal-content">
      <div class="modal-header">
        <h4 id="img-modal-title" class="modal-title">Image Detail</h4>
      </div>
      <div class="modal-body">
        <img id="img-modal-image" class="img-responsive">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-blue" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

        <footer>
            <section class="neutral some-space">
	<div class="container">
		<div class="row">
			<div class="col-sm-12 text-center">
				<h3>Get paid to write for Linode.</h3>
				<p class="lead">We're always expanding our docs. If you like to help people, can write, and want to earn some cash, learn how you can <a href="/docs/contribute">earn up to $300 for every guide you write</a> and we publish.</p>
			</div>
		</div>
	</div>
</section>
            <section id="pre-footer">
  <div class="container">
    <div class="row">
      <div class="col-sm-7">
        <span>Get started in the Linode Cloud today.</span>
      </div>
      <div class="col-sm-5 pad-xs">
        <a id="btn-signup-bottom" class="btn btn-lg btn-full btn-green" href="https://manager.linode.com/session/signup">Create an Account</a>
      </div>
    </div>
  </div>
</section>

<section class="dark">
  <div class="container">

    <div class="row">
      <div class="footer-col">
        <h5><a href="https://www.linode.com/linodes">Overview</a></h5>
        <ul>
          <li><a href="https://www.linode.com/pricing">Plans &amp; Pricing</a></li>
          <li><a href="https://www.linode.com/linodes">Features</a></li>
          <li><a href="https://www.linode.com/addons">Add-Ons</a></li>
          <li><a href="https://www.linode.com/managed">Managed</a></li>
          <li><a href="https://www.linode.com/professional-services">Professional Services</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h5><a href="https://linode.com/docs/">Resources</a></h5>
        <ul>
          <li><a href="https://linode.com/docs/">Guides &amp; Tutorials</a></li>
          <li><a href="https://www.linode.com/speedtest">Speed Test</a></li>
          <li><a href="https://forum.linode.com/">Forum</a></li>
          <li><a href="https://www.linode.com/chat">Chat</a></li>
          <li><a href="http://status.linode.com/">System Status</a></li>
        </ul>
      </div>


      <div class="footer-col">
        <h5><a href="https://www.linode.com/about">Company</a></h5>
        <ul>
          <li><a href="https://www.linode.com/about">About Us</a></li>
          <li><a href="https://blog.linode.com">Blog</a></li>
          <li><a href="https://www.linode.com/press">Press</a></li>
          <li><a href="https://www.linode.com/referrals">Referral System</a></li>
          <li><a href="https://www.linode.com/careers">Careers</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h5><a href="https://www.linode.com/contact">Contact Us</a></h5>
        <ul>
          <li><a href="tel:+18554546633">855-4-LINODE</a></li>
          <li><a href="tel:+18554546633">(855-454-6633)</a></li>
          <li><a href="tel:+16093807100">Intl.: +1 609-380-7100</a></li>
          <li><a href="mailto:support@linode.com">Email us</a></li>
          <li>
            <br />
            <a target="_blank" href="https://facebook.com/linode"><i class="fa fa-facebook-square"></i></a>
            <a target="_blank" href="https://twitter.com/linode"><i class="fa fa-twitter-square"></i></a>
            <a target="_blank" href="https://plus.google.com/+linode/"><i class="fa fa-google-plus-square"></i></a>
            <a target="_blank" href="https://linkedin.com/company/linode"><i class="fa fa-linkedin-square"></i></a>
            <a target="_blank" href="https://github.com/linode/"><i class="fa fa-github-square"></i></a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</section>

<section class="dark-moar">
  <div class="container">
    <div id="footer-copyright" class="row">
      <div class="col text-center">
        &copy; 2017 Linode, LLC
      </div>

      <div class="col text-center">
        <a href="https://www.linode.com/tos">Terms of Service</a>
      </div>

      <div class="col text-center">
        <a href="https://www.linode.com/privacy">Privacy Policy</a>
      </div>

      <div class="col text-center">
        <a href="https://www.linode.com/security">Security</a>
      </div>

      <div class="col text-center">
        <a href="https://www.linode.com/compliance">Standards &amp; Compliance</a>
      </div>
    </div>
  </div>
</section>

        </footer>
        
             <script src="/docs/build/js/libs.js" type="text/javascript"></script>
<script src="/docs/build/js/main.js" type="text/javascript"></script>

        
        <script type="text/javascript">
$( "img[src^='\/docs\/assets']" ).each(function () {
  $( this ).parent().bind('click', false);
  $( this ).on('click', function(e) {
    var image_title = $( this ).attr('alt');
    var image_href = $( this ).parent().attr('href') || $( this ).attr('src');
    $( '#img-modal-image' ).attr('src', image_href);
    $( '#img-modal-title' ).text(image_title);
    $( '#img-modal' ).modal({ show: true });
  });
});
</script>



        
<script type="text/javascript">
 SidebarScroll.init()
</script>

    </body>
</html>