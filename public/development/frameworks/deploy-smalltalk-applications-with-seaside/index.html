<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Deploy Smalltalk Applications with Seaside</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="description" content="An introductory guide to deploying applications with the Seaside Framework">
        <meta name="keywords" content="seaside, smalltalk, pharo, squeak, apache, framework">
        
        <meta property="og:title" content="Deploy Smalltalk Applications with Seaside">
        <meta property="og:type" content="article">
        <meta property="og:url" content="https://linode.com/docs/development/frameworks/deploy-smalltalk-applications-with-seaside/">
        <meta property="og:description" content="An introductory guide to deploying applications with the Seaside Framework">
        <meta property="og:site_name" content="Linode Guides &amp; Tutorials">
        
        
        <meta name="twitter:card" content="summary">
        
        <meta name="twitter:site" content="@linode">
        <link rel="alternate" type="application/rss" href="https://linode.com/docs/index.xml">

        
             <link href="/docs/build/stylesheets/home.css" rel='stylesheet' type='text/css'>

        
        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <link href='//fonts.googleapis.com/css?family=Lato:300,400,700,900' rel='stylesheet' type='text/css'>
        <link rel="canonical" href="https://linode.com/docs/development/frameworks/deploy-smalltalk-applications-with-seaside/">
        <link rel="shortcut icon" href="/favicon.ico">
    </head>
    <body class="no-subnav">
         <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="searchLabel" id="ds-search-modal">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div id="ds-search-input">
				<div class="input-group col-md-12">
					<input id="ds-search" type="text" class="form-control input-lg" placeholder="Search" />
					<span class="input-group-btn">
						<button class="btn btn-info btn-lg" id="ds-search-btn-modal" type="button">
						<i class="glyphicon glyphicon-search"></i>
						</button>
					</span>
				</div>
				<ul class="list-group" id="ds-search-list">
				</ul>
			</div>
		</div>
	</div>
</div> 
         
        <header>
            <nav id="main-nav" class="navbar navbar-default" role="navigation">
  <div class="container">

    <div class="navbar-header">
      <button type="button" class="toggle navbar-toggle" data-toggle="collapse" data-target=".navbar-top-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="https://www.linode.com"><img id="navbar-logo" src="/docs/media/images/header/linode-logo.svg" style="height:57px"></a>
    </div>

    <div class="collapse navbar-collapse navbar-top-collapse">
      <ul class="nav navbar-nav navbar-right">

                <li><a href="https://www.linode.com/"><span class='nav-home'></span></a></li>
                <li><a href="https://www.linode.com/linodes">Features</a></li>
                <li><a href="https://www.linode.com/pricing">Pricing</a></li>
                <li><a href="https://www.linode.com/addons">Add-ons</a></li>

        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Resources <span class="caret"></span></a>
          <ul class="dropdown-menu dropdown-main-nav dropdown-mega">
            <li class="dropdown-third">
              <ul >
                <li><a href="https://linode.com/docs/getting-started">Getting Started</a></li>
                <li><a href="https://linode.com/docs/migrate-from-shared">Migrating to Linode</a></li>
                <li><a href="https://linode.com/docs/hosting-website">Hosting a Website</a></li>
                <li class="divider"></li>
                <li class="big"><a href="https://linode.com/docs"><i class="fa fa-book"></i> Guides &amp; Tutorials</a></li>
                <li class="divider visible-xs"></li>
              </ul>
            </li>
            <li class="dropdown-third middle">
              <ul >
                <li><a href="https://www.linode.com/api">API</a></li>
                <li><a href="https://www.linode.com/stackscripts">StackScripts</a></li>
                <li><a href="https://www.linode.com/mobile">Mobile</a></li>
                <li><a href="https://www.linode.com/cli" target="_blank">CLI</a></li>

                <li class="divider"></li>

                <li><a href="https://www.linode.com/chat"><i class="fa fa-bullhorn gray"></i> Chat</a></li>
                <li><a href="https://forum.linode.com"><i class="fa fa-comments"></i> Community Forum</a></li>
                <li class="divider visible-xs"></li>
              </ul>
            </li>
            <li class="dropdown-third">
              <ul >
                <li><a href="https://blog.linode.com">Blog</a></li>
                <li><a href="http://status.linode.com">System Status</a></li>
                <li><a href="https://www.linode.com/speedtest">Speed Test</a></li>
                <li><a href="https://www.linode.com/about">About Us</a></li>
                <li class="divider"></li>
                <li><a href="https://www.linode.com/contact"><i class="fa fa-user"></i> Contact Support</a></li>
              </ul>
            </li>
          </ul>
        </li>

        <li role="presentation" class="divider-vertical"><span>|</span></li>
          <li class=""><a href="https://manager.linode.com/">Log in <span class="login-caret"></span></a></li>
          <li class="visible-xs"><a href="https://manager.linode.com/session/signup">Sign up</a></li>
          <li class="hidden-xs"><div><a id="btn-signup-top" class="btn btn-sm btn-green navbar-btn hidden-xs" href="https://manager.linode.com/session/signup">Sign up</a></div></li>
      </ul>
    </div>

  </div>
</nav>

            <nav class="navbar subnav jumbotron" role="navigation">
  <div class="container">
    <div class="subnav-divider">

    </div>
  </div>
</nav>
        </header>
        
<section class="primary first-section">
  <div class="container">
    <div class="row breadcrumb-row">
  <div class="col-sm-12">
    <ol class="breadcrumb library-breadcrumb">
      







<li>
  
  <a href="https://linode.com/docs/">Guides &amp; Tutorials</a>
  
</li>


<li>
  
  <a href="https://linode.com/docs/development/">Development</a>
  
</li>


<li>
  
  <a href="https://linode.com/docs/development/frameworks/">Web Application Frameworks</a>
  
</li>


<li>
  
  Deploy Smalltalk Applications with Seaside
  
</li>

    </ol>
  </div>
</div>

    <div class="row" itemscope itemtype="http://schema.org/TechArticle">
      <div class="col-sm-12">
        <div class="row">
          <div class="col-sm-9 col-sm-offset-3">
          </div>
        </div>
        <div class="row">
          <div id="article-body" class="col-sm-9 col-sm-push-3 doc">
            <h1 class="doc-title" itemprop="headline">Deploy Smalltalk Applications with Seaside</h1>
<p markdown="0" class="doc-time doc-modified-time">
  <small class="updated">Updated <time itemprop="dateModified" datetime="2013-09-27T00:00:00Z">Friday, September 27, 2013</time> by Linode</small>
  
</p>

           <div class="row">
            <div class="col-sm-9"><div markdown="0" class="signup-top">
    <span>
        Use promo code <strong>DOCS10</strong> for $10 credit on a new account.
    </span>
    <form action="https://manager.linode.com/session/signup" style="display: inline">
        <button type="submit" target="_blank" class="btn btn-blue btn-sm btn-border">Try this Guide</button>
    </form>
</div>
</div>
            <div class="col-sm-3"><div class="social-share">
    <div class="btn-group share-group">
        <a data-toggle="dropdown" class="btn btn-info">
            <i class="fa fa-share-alt fa-inverse"></i>
        </a>
        <button href="#" data-toggle="dropdown" class="btn btn-info dropdown-toggle share">
        <span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
            <li>
                <a data-original-title="Twitter" rel="tooltip"  href="https://twitter.com/share?url=https%3a%2f%2flinode.com%2fdocs%2fdevelopment%2fframeworks%2fdeploy-smalltalk-applications-with-seaside%2f&via=linode&text=Deploy%20Smalltalk%20Applications%20%e2%80%a6" class="btn btn-twitter" data-placement="left" target="_blank" rel="noopener">
                    <i class="fa fa-twitter"></i>
                </a>
            </li>
            <li>
                <a data-original-title="Facebook" rel="tooltip"  href="http://www.facebook.com/sharer.php?u=https%3a%2f%2flinode.com%2fdocs%2fdevelopment%2fframeworks%2fdeploy-smalltalk-applications-with-seaside%2f" class="btn btn-facebook" data-placement="left" target="_blank" rel="noopener">
                    <i class="fa fa-facebook"></i>
                </a>
            </li>
            <li>
                <a data-original-title="Hacker News" rel="tooltip"  href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2flinode.com%2fdocs%2fdevelopment%2fframeworks%2fdeploy-smalltalk-applications-with-seaside%2f&t=Deploy%20Smalltalk%20Applications%20with%20Seaside" class="btn btn-hacker-news" data-placement="left" target="_blank" rel="noopener">
                    <i class="fa fa-hacker-news "></i>
                </a>
            </li>
        </ul>
    </div>
</div></div>
            </div>
            <div class="library-github" markdown="0">
	<i class="fa fa-github"></i>
	<strong>Contribute on GitHub</strong>
	<p>
		
		<a href="https://github.com/linode/docs">View Project</a> |
		<a href="https://github.com/linode/docs/blob/master/docs/development/frameworks/deploy-smalltalk-applications-with-seaside.md">View File</a> |
		<a href="https://github.com/linode/docs/edit/master/docs/development/frameworks/deploy-smalltalk-applications-with-seaside.md">Edit File</a>
	</p>
</div>
            
            
<blockquote class="deprecated">
	<strong class="callout-title">Deprecated</strong>
	<div>This guide has been deprecated and is no longer being maintained.</div>
	<div>
		
	</div>
</blockquote>


            

<p>Seaside is a web development framework for the Smalltalk programing language. Seaside offers web developers a number of unique capabilities to create unique applications in an entirely object oriented manner. Seaside also provides helpful abstractions that allow developers to forgo manually generating HTML or managing URL callbacks. This also makes it possible for developers to design applications around user sessions rather than around pages.</p>

<p>Seaside is built in the Pharo implementation of Smalltalk, and is distributed in an image format. In this manner, you can install, run and develop your Seaside application on your local machine. When you have developed your application and are ready to deploy it, upload the image to your Linode. To provide access to Seaside applications, a larger front-end web server like Apache is used to proxy connections back to the Seaside application.</p>

<p>The architecture and scaling of websites developed with Seaside is highly dependent upon your site, and there are a number of approaches. Most common approaches use a number of images running in parallel in combination with a load balancing front-end server that provides &ldquo;sticky sessions&rdquo; to ensure that data and session information is preserved for data. Unlike many other web frameworks, Seaside does not store data in an external database server and instead uses a process of image snapshots which provide data persistence.</p>

<p>This document provides an overview of getting started with this Smalltalk web development framework. For the purposes of this example we&rsquo;ve deployed Seaside and the &ldquo;Pier&rdquo; content management system on a Debian 5 (Lenny) system. Because of the image-based nature of Smalltalk environments, the strategies and approaches for running Seaside applications may not vary between distributions much. Nevertheless, there may be some differences regarding the names of packages and configuration details for the web server. Other details should remain the same between various operating system distributions.</p>

<p>Before proceeding with Seaside and Smalltalk installations, we assume that you have followed our <a href="/docs/getting-started/">getting started guide</a>. You&rsquo;ll also need to install <a href="/docs/web-servers/apache/">Apache</a> in order to serve your Seaside application. If you are new to Linux server administration, you may be interested in our <a href="/docs/tools-reference/introduction-to-linux-concepts/">introduction to Linux concepts guide</a>, <a href="/content/beginners-guide/">beginner&rsquo;s guide</a> and <a href="/content/using-linux/administration-basics">administration basics guide</a>. One final disclaimer: the Smalltalk virtual machines are all built against 32-bit architectures, so for the best performance, do not deploy a 64-bit image with your Linode.</p>

<h1 id="installing-smalltalk-environments">Installing Smalltalk Environments</h1>

<p>Make sure your package repositories and installed programs are up to date by issuing the following commands:</p>

<pre><code>apt-get update
apt-get upgrade --show-upgraded
</code></pre>

<p>Most of the programing for your Smalltalk application will occur on your local system. Once you&rsquo;ve developed your image to a point where you&rsquo;re comfortable uploading the code base to a production environment, follow these steps to deploy your application.</p>

<p>First, we need to install the virtual machine to run the Smalltalk images. While Debian provides the Squeak Virtual Machine in the <code>squeak-vm</code> package, we&rsquo;re going to use the binaries for the Pharo virtual machine. We&rsquo;ll install the necessary binaries in the <code>/opt/</code> hierarchy. Issue the following commands:</p>

<pre><code>apt-get install unzip libfreetype6
cd /opt
wget http://gforge.inria.fr/frs/download.php/24736/pharo-vm-0.15.2f-linux.zip
unzip pharo-vm-0.15.2f-linux.zip
mv pharo-vm-0.15.2f-linux/ pharo-vm-15-2/
</code></pre>

<p><a href="/docs/tools-reference/linux-system-administration-basics#upload-files-to-a-remote-server">Upload the image file</a> of your Seaside application. For the purposes of this guide we will use the image produced by the &ldquo;Pier&rdquo; Content Management System. We&rsquo;ll store the application image in the directory beneath <code>/srv/www/</code> for the specific virtual host: in this example, we&rsquo;ll use <code>/srv/www/example.com/</code>. To download the ready-made image for Pier use the following sequence of commands:</p>

<pre><code>cd /srv/www/example.com/
wget http://pier.googlecode.com/files/Pier-1.2.app.zip
unzip Pier-1.2.app.zip
mv Pier-1.2.app/ pier-app-1.2/
</code></pre>

<p>Whenever downloading images and executables directly from upstream providers, it is important to maintain up to date versions of your software. Make sure you&rsquo;re downloading the latest versions of the software to avoid running into solved bugs and security vulnerabilities.</p>

<p>To start the Seaside application, use this command, altering the path to designate the location of your Smalltalk image as necessary. In these examples we use the <code>-headless</code> option to allow the Seaside image to run without a local graphical environment. In this example we initiate the <code>Pier</code> image downloaded above.</p>

<pre><code>/opt/pharo-vm-15-2/squeak -vm-display-null /srv/www/example.com/pier-app-1.2/Contents/Resources/pier.image
</code></pre>

<p>To test the Seaside application, access your domain in the browser on port <code>8080</code>:</p>

<pre><code>http://example.com:8080/seaside/
</code></pre>

<p>In this configuration, the Squeak VM instances run in the current terminal session. For production situations we recommend running your Smalltalk images in <a href="/docs/tools-reference/ssh/using-the-terminal#gnu-screen">GNU Screen</a>. To stop the current instance, simply hit &ldquo;ctrl-c&rdquo;.</p>

<p>The default configuration of the &ldquo;Pier&rdquo; image accessed above binds the Smalltalk server on port <code>8080</code> on both the local and the public interface. Ensure that both your application and system firewalls are configured to permit proper access prior to deployment. We&rsquo;re now ready to configure Apache to provide public access to your Smalltalk instance.</p>

<h1 id="configuring-apache">Configuring Apache</h1>

<p>The manner in which you architect your Seaside-based application is quite dependent upon the demands of your deployment. The following approaches cover basic practices for making your Seaside application accessible over the network.</p>

<p>Most of the configuration of Seaside occurs within a fully graphical Smalltalk interface. Apache requires some additional dependencies in order to run with Smalltalk. You will need to ensure that <code>mod_proxy</code> is enabled along with the <code>mod_http_proxy</code> library. Issue the following command to effect this change:</p>

<pre><code>a2enmod proxy proxy_http
</code></pre>

<p>In addition to enabling mod_proxy, you&rsquo;ll need to allow localhost to access the proxy. In <code>/etc/apache2/mods-enabled/proxy.conf</code>, add &ldquo;Allow from localhost&rdquo; in the <code>&lt;Proxy *&gt;</code> block:</p>

<dl class="file">
<dt>


		/etc/apache2/mods-enabled/proxy.conf 


</dt>
<dd>







<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-apache" data-lang="apache"><span class="lnt"> 1</span><span class="lnt"> 2</span><span class="lnt"> 3</span><span class="lnt"> 4</span><span class="lnt"> 5</span><span class="lnt"> 6</span><span class="lnt"> 7</span><span class="lnt"> 8</span><span class="lnt"> 9</span><span class="lnt">10</span><span class="lnt">11</span><span class="lnt">12</span><span class="lnt">13</span><span class="lnt">14</span><span class="lnt">15</span><span class="lnt">16</span><span class="lnt">17</span><span class="lnt">18</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-apache" data-lang="apache"><span class="nt">&lt;IfModule</span> <span class="s">mod_proxy.c</span><span class="nt">&gt;</span>
        <span class="c">#turning ProxyRequests on and allowing proxying from all may allow</span>
        <span class="c">#spammers to use your proxy to send email.</span>

        <span class="nb">ProxyRequests</span> <span class="k">Off</span>

        <span class="nt">&lt;Proxy</span> <span class="s">*</span><span class="nt">&gt;</span>
                <span class="nb">AddDefaultCharset</span> <span class="k">off</span>
                <span class="nb">Order</span> deny,allow
                <span class="nb">Allow</span> from localhost
        <span class="nt">&lt;/Proxy</span><span class="s"></span><span class="nt">&gt;</span>

        <span class="c"># Enable/disable the handling of HTTP/1.1 &#34;Via:&#34; headers.</span>
        <span class="c"># (&#34;Full&#34; adds the server version; &#34;Block&#34; removes all outgoing Via: he$</span>
        <span class="c"># Set to one of: Off | On | Full | Block</span>

        <span class="nb">ProxyVia</span> <span class="k">On</span>
<span class="nt">&lt;/IfModule</span><span class="s"></span><span class="nt">&gt;</span></code></pre></td></tr></table>
</div>
</div>
</dd>
</dl>

<p>In order to configure Apache to serve static content, you&rsquo;ll need to enable <code>mod_rewrite</code>. Run the following command to enable <code>mod_rewrite</code>:</p>

<pre><code>a2enmod rewrite
</code></pre>

<p>For higher volume deployments and architectures you may want to configure and use <code>mod_proxy_balancer</code>. Use the following command:</p>

<pre><code>a2enmod proxy_balancer
</code></pre>

<p>These are the only non-Smalltalk requirements. If your applications requires any additional dependencies you should install them at this juncture. After adding these modules, restart the Apache server with the following command:</p>

<pre><code>/etc/init.d/apache2 restart
</code></pre>

<h1 id="case-one-independent-virtual-hosts">Case One: Independent Virtual Hosts</h1>

<h3 id="configuring-apache-to-serve-static-content">Configuring Apache to Serve Static Content</h3>

<p>In addition to configuring Apache to pass requests for dynamic content to the Smalltalk virtual machine, it&rsquo;s a very good idea to allow Apache to serve static content separately from the dynamic content generated by Seaside. It&rsquo;s much more efficient to distribute static content directly from Apache, or some other dedicated web server, so that Seaside and the Smalltalk virtual machine aren&rsquo;t burdened with this rote task.</p>

<p>In this first approach, we&rsquo;ll set up a separate sub-domain and virtual host for static content. Initially both hosts can operate on the machine. However, when you need to scale you can easily move the dynamic content onto a separate server without affecting functionality. By static content, we mean images, sound files, Flash, and in some cases base CSS files.</p>

<p>With Apache installed, create the following Virtual Host file. Typically these are located in the <code>/etc/apache2/sites-available/</code> directory, and named by convention with the name of the virtual host (e.g. <code>static.example.com</code>). Be sure to change the <code>VirtualHost</code> IP to the IP of your Linode.</p>

<dl class="file-excerpt">
<dt>


		Apache Virtual Host Configuration 


</dt>
<dd>







<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-apache" data-lang="apache"><span class="lnt">1</span><span class="lnt">2</span><span class="lnt">3</span><span class="lnt">4</span><span class="lnt">5</span><span class="lnt">6</span><span class="lnt">7</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-apache" data-lang="apache"><span class="nt">&lt;VirtualHost</span> <span class="s">*:80</span><span class="nt">&gt;</span>
     <span class="nb">ServerAdmin</span> admin@example.com
     <span class="nb">ServerName</span> static.example.com
     <span class="nb">DocumentRoot</span> <span class="sx">/srv/www/static.example.com/public_html/</span>
     <span class="nb">ErrorLog</span> <span class="sx">/srv/www/static.example.com/logs/error.log</span>
     <span class="nb">CustomLog</span> <span class="sx">/srv/www/static.example.com/logs/access.log</span> combined
<span class="nt">&lt;/VirtualHost</span><span class="s"></span><span class="nt">&gt;</span></code></pre></td></tr></table>
</div>
</div>
</dd>
</dl>


<p>Create the necessary directories by issuing the following commands:</p>

<pre><code>mkdir -p /srv/www/static.example.com/public_html/
mkdir -p /srv/www/static.example.com/logs/
</code></pre>

<p>Enable the virtual host with the following command. Remember to replace <code>static.example.com</code> with the name of the virtual host file:</p>

<pre><code>a2ensite static.example.com
</code></pre>

<p>Reload the web server configuration to create the virtual host:</p>

<pre><code>/etc/init.d/apache2 reload
</code></pre>

<p>When building your application point, ensure all static content is served from URLs that begin with <code>http://static.example.com/</code> and the files are located at <code>/srv/www/static.example.com/public_html/</code>. You must create an <a href="/docs/networking/dns/dns-records-an-introduction#types-of-dns-records">A Record</a> that points to the domain of your Linode for <code>static.example.com</code> domain.</p>

<h3 id="configuring-apache-to-proxy-dynamic-requests-to-seaside">Configuring Apache to Proxy Dynamic Requests to Seaside</h3>

<p>Seaside applications are all provided by a server running inside the Smalltalk instance. The Apache web server functions as a front end and proxies requests for dynamic content to the Seaside instance. When you&rsquo;ve confirmed that the Smalltalk server is responding on <code>localhost</code> port <code>8080</code>, create the following <code>VirtualHost</code>. Remember to change the IP to the IP of your Linode.</p>

<dl class="file-excerpt">
<dt>


		Apache Virtual Host Configuration 


</dt>
<dd>







<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-apache" data-lang="apache"><span class="lnt"> 1</span><span class="lnt"> 2</span><span class="lnt"> 3</span><span class="lnt"> 4</span><span class="lnt"> 5</span><span class="lnt"> 6</span><span class="lnt"> 7</span><span class="lnt"> 8</span><span class="lnt"> 9</span><span class="lnt">10</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-apache" data-lang="apache"><span class="nt">&lt;VirtualHost</span> <span class="s">*:80</span><span class="nt">&gt;</span>
    <span class="nb">ProxyPreserveHost</span> <span class="k">On</span>
    <span class="nb">ServerName</span> example.com
    <span class="nb">ServerAlias</span> www.example.com

    <span class="nb">ErrorLog</span> <span class="sx">/srv/www/example.com/logs/error.log</span>
    <span class="nb">CustomLog</span> <span class="sx">/srv/www/example.com/logs/access.log</span> combined

    <span class="nb">RewriteEngine</span> <span class="k">On</span>
    <span class="nb">RewriteRule</span> ^/(.*)$ http://localhost:8080/seaside/lollipop/$1 [proxy,last]</code></pre></td></tr></table>
</div>
</div>
</dd>
</dl>


<pre><code>&gt; \&lt;/VirtualHost\&gt;
</code></pre>

<p>Alter the path in the <code>RewriteRule</code> to match the location and port of your application in this case, for the URL <code>http://localhost:8080/seaside/lollipop/</code> the application is located at <code>seaside/lollipop/</code> running on <code>localhost</code> port number 8080.</p>

<p>Your application may require additional rewrite rules and configuration. If you&rsquo;re running Pier, for example, you will want to use the following set of <code>Rewrite</code> specifications:</p>

<dl class="file-excerpt">
<dt>


		Apache Rewrite Rules 


</dt>
<dd>







<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-apache" data-lang="apache"><span class="lnt">1</span><span class="lnt">2</span><span class="lnt">3</span><span class="lnt">4</span><span class="lnt">5</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-apache" data-lang="apache"><span class="nb">RewriteEngine</span> <span class="k">On</span>
<span class="nb">RewriteRule</span> ^/seaside/pier(.*)$ http://example.net$1 [redirect,last]
<span class="nb">RewriteRule</span> ^/seaside/files/(.*)$ http://localhost:8080/seaside/files/$1 [proxy,last]
<span class="nb">RewriteCond</span> <span class="sx">/srv/www/example.net/public_html/</span>%{REQUEST_seaFILENAME} !-f
<span class="nb">RewriteRule</span> ^/(.*)$ http://localhost:8080/seaside/pier/$1 [proxy,last]</code></pre></td></tr></table>
</div>
</div>
</dd>
</dl>


<p>In addition, your application may require some extra configuration. Pier requires the hostname to be defined in its control panel as well as in the Seaside control panel. If you&rsquo;re using software written by a third-party, it&rsquo;s best that you follow their specific instructions.</p>

<h1 id="case-two-serve-static-and-dynamic-content-with-one-virtual-host">Case Two: Serve Static and Dynamic Content with One Virtual Host</h1>

<p>In this example, all content is provided by the same virtual host. The web server looks for static content in the <code>DocumentRoot</code>, and if it finds nothing there it hands the request to the Smalltalk server to provide the dynamic content. Modify your virtual host configuration file to resemble the following. Change the <code>VirtualHost</code> IP to the IP of your Linode.</p>

<dl class="file-excerpt">
<dt>


		Apache Virtual Host Configuration 


</dt>
<dd>







<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-apache" data-lang="apache"><span class="lnt"> 1</span><span class="lnt"> 2</span><span class="lnt"> 3</span><span class="lnt"> 4</span><span class="lnt"> 5</span><span class="lnt"> 6</span><span class="lnt"> 7</span><span class="lnt"> 8</span><span class="lnt"> 9</span><span class="lnt">10</span><span class="lnt">11</span><span class="lnt">12</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-apache" data-lang="apache"><span class="nt">&lt;VirtualHost</span> <span class="s">*:80</span><span class="nt">&gt;</span>
    <span class="nb">ProxyPreserveHost</span> <span class="k">On</span>
    <span class="nb">ServerName</span> example.com
    <span class="nb">ServerAlias</span> www.example.com
    <span class="nb">DocumentRoot</span> <span class="sx">/srv/www/example.com/public_html/</span>

    <span class="nb">ErrorLog</span> <span class="sx">/srv/www/example.com/logs/error.log</span>
    <span class="nb">CustomLog</span> <span class="sx">/srv/www/example.com/logs/access.log</span> combined

    <span class="nb">RewriteEngine</span> <span class="k">On</span>
    <span class="nb">RewriteCond</span> <span class="sx">/srv/www/example.com/public_html</span>%{REQUEST_FILENAME} !-f
    <span class="nb">RewriteRule</span> ^/(.*)$ http://localhost:8080/seaside/lollipop/$1 [proxy,last]</code></pre></td></tr></table>
</div>
</div>
</dd>
</dl>


<pre><code>&gt; \&lt;/VirtualHost\&gt;
</code></pre>

<p>The <code>!-f</code> option at the end of the <code>RewriteCond</code> rule tells Apache to only apply the following <code>RewriteRule</code> if there isn&rsquo;t a file found that matches the request.</p>

<p>Your application may require additional rewrite rules and configuration. If you&rsquo;re running Pier, for example, you will want to use the following set of <code>Rewrite</code> specifications:</p>

<dl class="file-excerpt">
<dt>


		Apache Rewrite Rules 


</dt>
<dd>







<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-apache" data-lang="apache"><span class="lnt">1</span><span class="lnt">2</span><span class="lnt">3</span><span class="lnt">4</span><span class="lnt">5</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-apache" data-lang="apache"><span class="nb">RewriteEngine</span> <span class="k">On</span>
<span class="nb">RewriteRule</span> ^/seaside/pier(.*)$ http://example.net$1 [redirect,last]
<span class="nb">RewriteRule</span> ^/seaside/files/(.*)$ http://localhost:8080/seaside/files/$1 [proxy,last]
<span class="nb">RewriteCond</span> <span class="sx">/srv/www/example.net/public_html/</span>%{REQUEST_seaFILENAME} !-f
<span class="nb">RewriteRule</span> ^/(.*)$ http://localhost:8080/seaside/pier/$1 [proxy,last]</code></pre></td></tr></table>
</div>
</div>
</dd>
</dl>


<p>In addition, your application may require some extra configuration. Pier requires the hostname to be defined in its control panel, as well as in the Seaside control panel. If you&rsquo;re using software written by a third-party, it&rsquo;s best that you follow their specific instructions.</p>

<h1 id="configure-apache-proxy-cluster">Configure Apache Proxy Cluster</h1>

<p>In this example, we scale our Seaside deployment by providing Apache with multiple Seaside images running in parallel. In this setup, each Seaside instance runs on successive ports. This must be configured inside of the Seaside image. This configuration sets a <code>stickysession</code> cookie which allows users to maintain consistent connections to the same Smalltalk image. The various instances of your application will need to be configured to share information, so that updates to one image will be passed to other images. Alternatively, your application may be designed so that user experience will be unaffected by which back-end server they access.</p>

<p>This example expounds on the previous approach, where static content was served directly from Apache and dynamic content is passed to Seaside. Consider the following configuration example:</p>

<dl class="file-excerpt">
<dt>


		Apache Virtual Host Configuration 


</dt>
<dd>







<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-apache" data-lang="apache"><span class="lnt"> 1</span><span class="lnt"> 2</span><span class="lnt"> 3</span><span class="lnt"> 4</span><span class="lnt"> 5</span><span class="lnt"> 6</span><span class="lnt"> 7</span><span class="lnt"> 8</span><span class="lnt"> 9</span><span class="lnt">10</span><span class="lnt">11</span><span class="lnt">12</span><span class="lnt">13</span><span class="lnt">14</span><span class="lnt">15</span><span class="lnt">16</span><span class="lnt">17</span><span class="lnt">18</span><span class="lnt">19</span><span class="lnt">20</span><span class="lnt">21</span><span class="lnt">22</span><span class="lnt">23</span><span class="lnt">24</span><span class="lnt">25</span><span class="lnt">26</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-apache" data-lang="apache"><span class="nt">&lt;VirtualHost</span> <span class="s">*:80</span><span class="nt">&gt;</span>
    <span class="nb">ProxyPreserveHost</span> <span class="k">On</span>
    <span class="nb">ServerName</span> example.com
    <span class="nb">ServerAlias</span> www.example.com
    <span class="nb">ErrorLog</span> <span class="sx">/srv/www/example.com/logs/error.log</span>
    <span class="nb">CustomLog</span> <span class="sx">/srv/www/example.com/logs/access.log</span> combined

    <span class="nb">DocumentRoot</span> <span class="sx">/srv/www/example.com/public_html/</span>
    <span class="nt">&lt;Directory</span> <span class="s">/srv/www/example.com/public_html</span><span class="nt">&gt;</span>
       <span class="nb">Order</span> deny,allow
       <span class="nb">Allow</span> from <span class="k">all</span>
    <span class="nt">&lt;/Directory</span><span class="s"></span><span class="nt">&gt;</span>

    <span class="nb">ProxyPass</span> / balancer://cluster/ lbmethod=byrequests
    <span class="nb">ProxyPassReverse</span> / balancer://cluster/
    <span class="nt">&lt;Proxy</span> <span class="s">balancer://cluster</span><span class="nt">&gt;</span>
       <span class="nb">BalancerMember</span> http://localhost:8080/seaside/appname/ smax=5 route=seaside1
       <span class="nb">BalancerMember</span> http://localhost:8081/seaside/appname/ smax=5 route=seaside2
       <span class="nb">BalancerMember</span> http://localhost:8082/seaside/appname/ smax=5 route=seaside3
    <span class="nt">&lt;/Proxy</span><span class="s"></span><span class="nt">&gt;</span>

    <span class="nb">RewriteEngine</span> <span class="k">On</span>
    <span class="nb">RewriteCond</span> <span class="sx">/srv/www/example.com/public_html</span>%{REQUEST_FILENAME} !-f
    <span class="nb">RewriteRule</span>  ^/(.*)$ $1 [CO=BALANCEID:balancer.seaside1]
    <span class="nb">RewriteRule</span>  ^/(.*)$ $1 [CO=BALANCEID:balancer.seaside2]
    <span class="nb">RewriteRule</span>  ^/(.*)$ $1 [CO=BALANCEID:balancer.seaside3]</code></pre></td></tr></table>
</div>
</div>
</dd>
</dl>


<pre><code>&gt; \&lt;/VirtualHost\&gt;
</code></pre>

<p>In this example there are a couple of specific settings that you may need to modify based on the nature of your deployment. The most important value is the <code>smax</code> value set in the <code>BalancerMember</code> declarations. This value creates a &ldquo;soft maximum&rdquo; number of connections; any active connections greater than this number are subject to a timeout. You can set hard maximums by specifying a <code>max=</code> value as part of this declaration.</p>

<p>You can specify as many members of the balancing cluster as you need. <code>mod_proxy_balancer</code> makes it possible to balance requests among a pool that includes services running on both the local machine and/or various remote locations. It&rsquo;s common to run services on a number of distinct machines and proxy requests over the private network connections. Regardless of the actual architecture of deployment, ensure that each <code>BalancerMember</code> directive has a unique <code>route=</code> id, and that there is a corresponding <code>RewriteRule</code> with a final identifier that matches each of the previously created routes.</p>

<h1 id="more-information">More Information</h1>

<p>You may wish to consult the following resources for additional information on this topic. While these are provided in the hope that they will be useful, please note that we cannot vouch for the accuracy or timeliness of externally hosted materials.</p>

<ul>
<li><a href="http://book.seaside.st/book/">The Seaside Book</a></li>
<li><a href="http://www.squeaksource.com/">Squeak Source</a></li>
<li><a href="http://www.squeak.org/">Squeak</a></li>
<li><a href="http://squeakvm.org/unix/">Unix Squeak</a></li>
<li><a href="http://www.pharo-project.org/home">Pharo</a></li>
<li><a href="http://www.pharobyexample.org/">Pharo By Example</a></li>
<li><a href="http://www.piercms.com/">Pier CMS</a></li>
<li><a href="http://httpd.apache.org/docs/2.2/mod/mod_proxy_balancer.html">Apache Documentation for mod_proxy_balancer</a></li>
</ul>

            

            

<h2>See Also</h2>
<ul>
    
    
    <li><a href="/docs/web-servers/apache/host-your-own-rss-reader-with-tiny-tiny-rss-on-centos-7/">Host Your Own RSS Reader with Tiny Tiny RSS on CentOS 7</a></li>
    
    
    
    <li><a href="/docs/web-servers/apache/install-and-configure-apache-on-centos-7/">How to Install Apache on CentOS 7</a></li>
    
    
    
    <li><a href="/docs/websites/cms/update-and-secure-drupal-8-on-ubuntu/">Update and Secure Drupal 8 on Ubuntu or Debian</a></li>
    
    
    
    <li><a href="/docs/websites/cms/install-wordpress-using-wp-cli-on-ubuntu-14-04/">Install WordPress Using WP-CLI on Ubuntu 14.04</a></li>
    
    
    
    <li><a href="/docs/web-servers/apache/install-php-fpm-and-apache-on-debian-8/">Install PHP-FPM and Apache on Debian 8 (Jessie)</a></li>
    
    
</ul>


            
            
<p class="doc-license">This guide is published under a <a href="https://creativecommons.org/licenses/by-nd/4.0">CC BY-ND 4.0</a> license.</p>

          </div>
          <div id="doc-sidebar-container" class="col-sm-3 col-sm-pull-9 hidden-xs">
            <div id="doc-sidebar">
              <div markdown="0" class="doc-sidebar-inner" >
  <div class="input-group">
	<label class="sr-only" for="q">Search guides and tutorials</label>
	<input id="ss_keyword" name="q" type="text" class="form-control" placeholder="Search guides..."/>
	<span class="input-group-btn">
		<button type="submit" class="btn btn-blue" id="ds-search-btn"><span class="glyphicon glyphicon-search"></span></button>
	</span>
</div>
</div>

                
              <div class="doc-sidebar-inner" id="doc-sidebar-toc">
                <h3 id="doc-sidebar-title">In This Guide:</h3>
                <div class="sidebar sidebar-library nav navbar" id="markdown-toc">
                    <nav id="TableOfContents">
<ul>
<li><a href="#installing-smalltalk-environments">Installing Smalltalk Environments</a></li>
<li><a href="#configuring-apache">Configuring Apache</a></li>
<li><a href="#case-one-independent-virtual-hosts">Case One: Independent Virtual Hosts</a>
<ul>
<li>
<ul>
<li><a href="#configuring-apache-to-serve-static-content">Configuring Apache to Serve Static Content</a></li>
<li><a href="#configuring-apache-to-proxy-dynamic-requests-to-seaside">Configuring Apache to Proxy Dynamic Requests to Seaside</a></li>
</ul></li>
</ul></li>
<li><a href="#case-two-serve-static-and-dynamic-content-with-one-virtual-host">Case Two: Serve Static and Dynamic Content with One Virtual Host</a></li>
<li><a href="#configure-apache-proxy-cluster">Configure Apache Proxy Cluster</a></li>
<li><a href="#more-information">More Information</a></li>
</ul>
</nav>
                </div>
              </div>
              
              <div class="library-rss">
  <a href="https://linode.com/docs/index.xml"><i class="fa fa-rss-square"></i> RSS feed</a>
</div>

              <div markdown="0" class="library-signup">
  <form action="//linode.us7.list-manage.com/subscribe/post?u=f9b54ed743e1629877750e3f4&amp;id=68bafea72a&SIGNUP=library-website"
    method="post" class="email-signup" target="_blank" novalidate="">
    <i class="fa fa-envelope"></i>
    <h6>Monthly Guides Update</h6>
    <input name="EMAIL" type="email" class="form-control input-sm"
    placeholder="Email address" required="" />
    <div style="position: absolute; left: -5000px;" aria-hidden="true">
      <input type="text" name="b_f9b54ed743e1629877750e3f4_68bafea72a"
      tabindex="-1" value="">
    </div>
    <div style="display:none">
      <input type="checkbox" value="4" name="group[13][4]"
      id="mce-group[13]-13-0" checked="">
    </div>
    <button type="submit" class="btn btn-blue btn-sm btn-border email-signup" value="Subscribe"
    name="subscribe" id="mc-embedded-subscribe">Sign Up</button>
  </form>
</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<div class="modal fade" id="img-modal" tabindex="-1" role="dialog" aria-labelledby="imageModal" aria-hidden="true">
  <div class="modal-dialog modal-full">
    <div class="modal-content">
      <div class="modal-header">
        <h4 id="img-modal-title" class="modal-title">Image Detail</h4>
      </div>
      <div class="modal-body">
        <img id="img-modal-image" class="img-responsive">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-blue" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

        <footer>
            <section class="neutral some-space">
	<div class="container">
		<div class="row">
			<div class="col-sm-12 text-center">
				<h3>Get paid to write for Linode.</h3>
				<p class="lead">We're always expanding our docs. If you like to help people, can write, and want to earn some cash, learn how you can <a href="/docs/contribute">earn up to $300 for every guide you write</a> and we publish.</p>
			</div>
		</div>
	</div>
</section>
            <section id="pre-footer">
  <div class="container">
    <div class="row">
      <div class="col-sm-7">
        <span>Get started in the Linode Cloud today.</span>
      </div>
      <div class="col-sm-5 pad-xs">
        <a id="btn-signup-bottom" class="btn btn-lg btn-full btn-green" href="https://manager.linode.com/session/signup">Create an Account</a>
      </div>
    </div>
  </div>
</section>

<section class="dark">
  <div class="container">

    <div class="row">
      <div class="footer-col">
        <h5><a href="https://www.linode.com/linodes">Overview</a></h5>
        <ul>
          <li><a href="https://www.linode.com/pricing">Plans &amp; Pricing</a></li>
          <li><a href="https://www.linode.com/linodes">Features</a></li>
          <li><a href="https://www.linode.com/addons">Add-Ons</a></li>
          <li><a href="https://www.linode.com/managed">Managed</a></li>
          <li><a href="https://www.linode.com/professional-services">Professional Services</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h5><a href="https://linode.com/docs/">Resources</a></h5>
        <ul>
          <li><a href="https://linode.com/docs/">Guides &amp; Tutorials</a></li>
          <li><a href="https://www.linode.com/speedtest">Speed Test</a></li>
          <li><a href="https://forum.linode.com/">Forum</a></li>
          <li><a href="https://www.linode.com/chat">Chat</a></li>
          <li><a href="http://status.linode.com/">System Status</a></li>
        </ul>
      </div>


      <div class="footer-col">
        <h5><a href="https://www.linode.com/about">Company</a></h5>
        <ul>
          <li><a href="https://www.linode.com/about">About Us</a></li>
          <li><a href="https://blog.linode.com">Blog</a></li>
          <li><a href="https://www.linode.com/press">Press</a></li>
          <li><a href="https://www.linode.com/referrals">Referral System</a></li>
          <li><a href="https://www.linode.com/careers">Careers</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h5><a href="https://www.linode.com/contact">Contact Us</a></h5>
        <ul>
          <li><a href="tel:+18554546633">855-4-LINODE</a></li>
          <li><a href="tel:+18554546633">(855-454-6633)</a></li>
          <li><a href="tel:+16093807100">Intl.: +1 609-380-7100</a></li>
          <li><a href="mailto:support@linode.com">Email us</a></li>
          <li>
            <br />
            <a target="_blank" href="https://facebook.com/linode"><i class="fa fa-facebook-square"></i></a>
            <a target="_blank" href="https://twitter.com/linode"><i class="fa fa-twitter-square"></i></a>
            <a target="_blank" href="https://plus.google.com/+linode/"><i class="fa fa-google-plus-square"></i></a>
            <a target="_blank" href="https://linkedin.com/company/linode"><i class="fa fa-linkedin-square"></i></a>
            <a target="_blank" href="https://github.com/linode/"><i class="fa fa-github-square"></i></a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</section>

<section class="dark-moar">
  <div class="container">
    <div id="footer-copyright" class="row">
      <div class="col text-center">
        &copy; 2017 Linode, LLC
      </div>

      <div class="col text-center">
        <a href="https://www.linode.com/tos">Terms of Service</a>
      </div>

      <div class="col text-center">
        <a href="https://www.linode.com/privacy">Privacy Policy</a>
      </div>

      <div class="col text-center">
        <a href="https://www.linode.com/security">Security</a>
      </div>

      <div class="col text-center">
        <a href="https://www.linode.com/compliance">Standards &amp; Compliance</a>
      </div>
    </div>
  </div>
</section>

        </footer>
        
             <script src="/docs/build/js/libs.js" type="text/javascript"></script>
<script src="/docs/build/js/main.js" type="text/javascript"></script>

        
        <script type="text/javascript">
$( "img[src^='\/docs\/assets']" ).each(function () {
  $( this ).parent().bind('click', false);
  $( this ).on('click', function(e) {
    var image_title = $( this ).attr('alt');
    var image_href = $( this ).parent().attr('href') || $( this ).attr('src');
    $( '#img-modal-image' ).attr('src', image_href);
    $( '#img-modal-title' ).text(image_title);
    $( '#img-modal' ).modal({ show: true });
  });
});
</script>



        
<script type="text/javascript">
 SidebarScroll.init()
</script>

    </body>
</html>