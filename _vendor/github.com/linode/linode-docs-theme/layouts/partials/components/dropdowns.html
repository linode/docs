{{ $dropdowns := slice }}
{{ range .dropdowns }}
  {{ $dropdowns =  $dropdowns | append (dict "open" (.open | default false ) "hideWhenPinned" (.hideWhenPinned | default false) )}}
{{ end }}

<div class="flex justify-start space-x-2" x-data="lnc.NewDropdownsController({{ $dropdowns | jsonify }})" x-init="init()" @nav:toggle.document="receiveToggle($event.detail)" @click.away="closeAll()">
  {{ range $i, $e := .dropdowns }}
    <div x-show.transition.opacity="!isHidden({{ $i }})" x-cloak>
      <div class="relative inline-block text-left">
        <div>
          <span class="rounded-sm">
            <button type="button" aria-label="open" @click="toggleOpen({{ $i }})" :class="{ 'bg-white border-basicgray': isOpen({{ $i }})}"
                        class="btn-icon inline-flex w-full rounded-sm border border-gray-300 px-4 py-2 md:px-2 md:py-1 text-sm leading-4 font-medium text-gray-700 hover:text-gray-500 focus:outline-none active:bg-gray-50 active:text-titlecolor transition ease-in-out duration-150">
              {{ with .icon }}
                <svg class="fill-current text-textcolor w-4 h-4">
                  <use href="{{ . | safeHTMLAttr }}"></use>
                </svg>
              {{ end }}
              <div x-show="isOpen({{ $i }})">
                <svg class="fill-current text-textcolor -mr-1 ml-2 h-4 w-4">
                  <use href="#icon--arrow-up"></use>
                </svg>
              </div>
              <div x-show="!isOpen({{ $i }})">
                <svg class="fill-current text-textcolor -mr-1 ml-2 h-4 w-4">
                  <use href="#icon--arrow-down"></use>
                </svg>
              </div>
            </button>
          </span>
        </div>
        <div x-show.transition="isOpen({{ $i }})" class="origin-top-right absolute left-0 md:right-0 mt-2 w-64 z-10 rounded-sm border border-basicgray" x-cloak>
          <div class="rounded-sm bg-white">
            {{ if .contentPartial }}
              {{ partial .contentPartial . }}
            {{ end }}
          </div>
        </div>
      </div>
    </div>
  {{ end }}
</div>