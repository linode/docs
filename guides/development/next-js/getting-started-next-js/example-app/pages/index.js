// Import the JSX and style modules to be used for the page. The CSS file
// here is the default one for a base Next project.
import Head from 'next/head'
import styles from '../styles/Home.module.css'

// Import the React modules for state variables and effects.
import {useState, useEffect} from 'react'

// Create the function for the home page.
export default function Home() {
  // Initialize the state variable and its set function.
  const [postsData, setPostsData] = useState([]);

  // Have the page load post data from the API on page load.
  useEffect(() => {
    fetch('/api/posts')
      .then((res) => res.json())
      .then((data) => setPostsData(data))
  }, [])

  // Render the page template.
  return (
    <div className={styles.container}>
      <Head>
        <title>My Next.js Profile Page</title>
        <meta name='description' content='Generated by create next app' />
        <link rel='icon' href='/favicon.ico' />
      </Head>

      <main className={styles.main}>
        <h1 className={styles.title}>
          Example User â€” a Profile
        </h1>

        <div className={styles.grid}>
          <div className={styles.card}>
            <p>Learn <a href='/about'>about me</a>!</p>
          </div>

          <div className={styles.card}>
            <p>Take a look at my stuff:</p>
            <ul>
              {postsData.map((postData) => (
                <li key={postData.slug}>
                  <a href={ '/posts/' + postData.slug }>{postData.name}</a>
                </li>
              ))}
            </ul>
          </div>
        </div>
      </main>

      <footer className={styles.footer}>
        Created for a Linode guide
      </footer>
    </div>
  )
}

